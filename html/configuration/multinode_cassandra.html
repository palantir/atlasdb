<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Multinode Cassandra HA Guarantees &mdash; OSS AtlasDB develop documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/release-notes.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Enabling Cassandra Tracing" href="enabling_cassandra_tracing.html" />
    <link rel="prev" title="Cassandra Configuration" href="cassandra_config.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> OSS AtlasDB
          </a>
              <div class="version">
                develop
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview/index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schemas/index.html">Schemas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transactions/index.html">Transactions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="key_value_service_configs/index.html">Key Value Service Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="external_timelock_service_configs/index.html">External Timelock Service Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="cassandra_config.html">Cassandra Configuration</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Multinode Cassandra HA Guarantees</a></li>
<li class="toctree-l2"><a class="reference internal" href="enabling_cassandra_tracing.html">Enabling Cassandra Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="leader_config.html">Leader Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="timestamp_client.html">Timestamp Client Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="internal_schemas.html">Internal Schema Configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../cluster_management/index.html">Cluster Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/index.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance/index.html">Performance Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/index.html">Miscellaneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting/index.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes/index.html">Releases</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">OSS AtlasDB</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Configuration</a> &raquo;</li>
      <li>Multinode Cassandra HA Guarantees</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/palantir/atlasdb/blob/develop/docs/source/configuration/multinode_cassandra.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="multinode-cassandra-ha-guarantees">
<h1>Multinode Cassandra HA Guarantees<a class="headerlink" href="#multinode-cassandra-ha-guarantees" title="Permalink to this headline"></a></h1>
<p>A multinode Cassandra cluster can generally be in one of three states:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>All nodes are up.</p></li>
<li><p>Some nodes are down, but there is a quorum of up nodes, i.e., the number of nodes that are down is fewer than half the replication factor (RF).</p></li>
<li><p>Less than a quorum of the nodes are up.</p></li>
</ol>
</div></blockquote>
<p>In the case where all nodes are up, the entire Cassandra Key Value Service (KVS) API can be used. In the latter two cases, in order to guarantee consistency and correctness, usage of the KVS API is restricted as documented below.</p>
<section id="a-minority-of-nodes-are-down">
<h2>A minority of nodes are down<a class="headerlink" href="#a-minority-of-nodes-are-down" title="Permalink to this headline"></a></h2>
<p>The following behaviour is guaranteed when interacting with a Cassandra cluster with three nodes, RF three, and one node down. More generally, the following is the expected behaviour for a cluster that has nodes down, but can still always satisfy QUORUM requests (i.e. fewer than RF/2 nodes are down).</p>
<table class="colwidths-given docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Cassandra KVS API Method</p></th>
<th class="head"><p>Behaviour</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">addGarbageCollectionSentinelValues</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cleanUpSchemaMutationLockTablesState</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">close</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">compactInternally</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">create</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">createTable</span></code></p></td>
<td><p>Throws <code class="docutils literal notranslate"><span class="pre">IllegalStateException</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">createTables</span></code></p></td>
<td><p>Throws <code class="docutils literal notranslate"><span class="pre">IllegalStateException</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">delete</span></code></p></td>
<td><p>Throws <code class="docutils literal notranslate"><span class="pre">PalantirRuntimeException</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">dropTable</span></code></p></td>
<td><p>Throws <code class="docutils literal notranslate"><span class="pre">IllegalStateException</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dropTables</span></code></p></td>
<td><p>Throws <code class="docutils literal notranslate"><span class="pre">IllegalStateException</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">getAllTableNames</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">getAllTimestamps</span></code></p></td>
<td><p>Throws <code class="docutils literal notranslate"><span class="pre">PalantirRuntimeException</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">getLatestTimestamps</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">getMetadataForTable</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">getMetadataForTables</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">getRange</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">getRangeOfTimestamps</span></code></p></td>
<td><p>Throws <code class="docutils literal notranslate"><span class="pre">InsufficientConsistencyException</span></code> (<cite>when the iterator is accessed</cite>).</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">getRows</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">getRowsColumnRange</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">multiPut</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">put</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">putMetadataForTable</span></code></p></td>
<td><p>Throws <code class="docutils literal notranslate"><span class="pre">IllegalStateException</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">putMetadataForTables</span></code></p></td>
<td><p>Throws <code class="docutils literal notranslate"><span class="pre">IllegalStateException</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">putUnlessExists</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">putWithTimestamps</span></code></p></td>
<td><p>Same as when all nodes are up.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">truncateTable</span></code></p></td>
<td><p>Throws <code class="docutils literal notranslate"><span class="pre">PalantirRuntimeException</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">truncateTables</span></code></p></td>
<td><p>Throws <code class="docutils literal notranslate"><span class="pre">PalantirRuntimeException</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="less-than-a-quorum-of-nodes-are-up">
<h2>Less than a quorum of nodes are up<a class="headerlink" href="#less-than-a-quorum-of-nodes-are-up" title="Permalink to this headline"></a></h2>
<p>All of the above operations should fail.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This behaviour has not been fully tested yet!</p>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cassandra_config.html" class="btn btn-neutral float-left" title="Cassandra Configuration" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="enabling_cassandra_tracing.html" class="btn btn-neutral float-right" title="Enabling Cassandra Tracing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2017, Palantir Technologies.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>